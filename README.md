<h1>Api-авторизация с режимом impersonate (войти под пользователем)</h1>

<h3>Инструменты</h3>
`Laravel: 9.28` `PHP: v8.1`, `Composer: v2.3`, `Docker`

<h2>Зaдача</h3>
1.Реализовать авторизацию для мобильных клиентов на Laravel.

1. Пользователь вводит в приложении номер телефона, получает смс код и вводит его.
2. Предусмотреть режим impersonate - администратор вводит в приложении номер телефона + код (например,
   79100010101992354), получает каким то образом код авторизации, который в обычном режиме приходит в смс. (Задача
   со свездочкой, можно не делать)

<h2>Разворачивание</h2>
Для разворачивания можно использовать `docker` и команду `vendor/bin/sail`,
если же вы не используйте докер, выполните те же действия в папке проекта, а не в контейнере, заменив `vendor/bin/sail`
на `php`

- `composer install`
- `vendor/bin/sail up -d`
- `cp .env.example .env`
- `vendor/bin/sail artisan key:generate`

Укажите тестовые данные в _.env_:  
**TEST_PHONE_NUMBER -** номер телефона пользователя для создания тестового пользователя.  
**SMSRU_API_KEY -** ваш api-ключ для использования сервиса SMS.RU.

Примечание: в данном решение используется сервис SMS.RU, соответственно, для проверки,
необходимо указать номер телефона, зарегестрированный в сервисе, а так же ваш api-ключ.
Данный сервис предоставляет 5 бесплатных смс в день, на номер владельца аккаунта, на момент
решения задачи.

**ADMIN_EMAIL -** email администратора, на который будет приходить код в режиме **impersonate**.  
Примечание:на данный момент у почтового режима стоит драйвер **_log_ (MAIL_MAILER=log)**. Вы можете подключить
и настроить любой драйвер, поддерживаемый **Laravel**.

**IMPERSONATE_CODE=992354 -** установлен код по умолчанию, для авторизации под аккаунтом пользователя,
вы можете изменить его на любой другой.

Выполните миграции `vendor/bin/sail artisan migrate` или `vendor/bin/sail artisan migrate --seed` - для создания
тестового пользователя

Проект разворачивается на _localhost_.  
Маршруты:  
`POST('localhost/api/v1/auth/login', [phone => *])`  
`POST('localhost/api/v1/auth/code', [phone => *, code =>*])`  
Так же, не забудьте указать загаловок:  
`X-Requested-With:XMLHttpRequest`

В раммках данного решения, я использовал драйвер очередей sync и почтовый драйвер log, 
исключительно для проверки работы. Естественно в продакшене их использовать не рекомендуется,
но подключить эти драйверы не составит проблем, обратившись к документации laravel.
